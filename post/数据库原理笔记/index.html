<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>数据库原理笔记 - Zhou Jun&#39;s blog</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="周军" /><meta name="description" content="增 删 改 查 几乎所有的应用软件都需要数据库 数据库与数据结构的区别？ 数据库是在应用软件级别研究数据的存储和操作 外存级别（硬盘） 数据结构是在系统软件" /><meta name="keywords" content="Hugo, theme, even" />






<meta name="generator" content="Hugo 0.57.2 with even 4.0.0" />


<link rel="canonical" href="https://junzhoublog.github.io/post/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E7%AC%94%E8%AE%B0/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">


<link href="/dist/even.c2a46f00.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="数据库原理笔记" />
<meta property="og:description" content="增 删 改 查 几乎所有的应用软件都需要数据库 数据库与数据结构的区别？ 数据库是在应用软件级别研究数据的存储和操作 外存级别（硬盘） 数据结构是在系统软件" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://junzhoublog.github.io/post/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86%E7%AC%94%E8%AE%B0/" />
<meta property="article:published_time" content="2019-09-10T22:33:46+08:00" />
<meta property="article:modified_time" content="2019-09-10T22:33:46+08:00" />
<meta itemprop="name" content="数据库原理笔记">
<meta itemprop="description" content="增 删 改 查 几乎所有的应用软件都需要数据库 数据库与数据结构的区别？ 数据库是在应用软件级别研究数据的存储和操作 外存级别（硬盘） 数据结构是在系统软件">


<meta itemprop="datePublished" content="2019-09-10T22:33:46&#43;08:00" />
<meta itemprop="dateModified" content="2019-09-10T22:33:46&#43;08:00" />
<meta itemprop="wordCount" content="4942">



<meta itemprop="keywords" content="sqlserver,mysql,db2," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="数据库原理笔记"/>
<meta name="twitter:description" content="增 删 改 查 几乎所有的应用软件都需要数据库 数据库与数据结构的区别？ 数据库是在应用软件级别研究数据的存储和操作 外存级别（硬盘） 数据结构是在系统软件"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Computer</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">主页</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">归档</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">标签</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">分类</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">关于</li>
      </a>
  </ul>
</nav>
  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">Computer</a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">主页</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">归档</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">标签</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">分类</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">关于</a>
      </li>
  </ul>
</nav>
    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">数据库原理笔记</h1>

      <div class="post-meta">
        <span class="post-time"> 2019-09-10 </span>
        <div class="post-category">
            <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/"> 计算机 </a>
            </div>
          <span class="more-meta"> 约 4942 字 </span>
          <span class="more-meta"> 预计阅读 10 分钟 </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
<ul>
<li><a href="#基础内容">基础内容</a></li>
<li><a href="#查询-顺序">查询 (顺序)</a>
<ul>
<li><a href="#计算机列">计算机列</a></li>
<li><a href="#distinct-不允许重复的">distinct(不允许重复的)</a></li>
<li><a href="#between-在某个范围">between(在某个范围)</a></li>
<li><a href="#in-属于若干个孤立的值">in(属于若干个孤立的值)</a></li>
<li><a href="#top-最前面的若干个记录-专属sql-server的语法-不可移植到其他数据库">top(最前面的若干个记录 专属sql server的语法，不可移植到其他数据库)</a></li>
<li><a href="#null-没有值-空值">null（没有值，空值）</a></li>
<li><a href="#order-by-以某个字段排序">order by (以某个字段排序)</a></li>
<li><a href="#模糊查询-搜索时经常用">模糊查询 (搜索时经常用)</a></li>
<li><a href="#聚合函数-多行记录返回一个值通常用于统计分组信息">聚合函数（多行记录返回一个值通常用于统计分组信息）</a></li>
<li><a href="#group-by-分组-重点">group by (分组)【重点】</a></li>
<li><a href="#having-对分组之后的信息过滤-难点">having[对分组之后的信息过滤 难点]</a></li>
<li><a href="#连接查询">连接查询</a>
<ul>
<li><a href="#内连接">内连接</a></li>
<li><a href="#外连接">外连接</a></li>
<li><a href="#完全连接">完全连接</a></li>
<li><a href="#交叉连接">交叉连接</a></li>
<li><a href="#自连接">自连接</a></li>
</ul></li>
<li><a href="#嵌套查询">嵌套查询</a></li>
</ul></li>
<li><a href="#视图">视图</a></li>
</ul>
</nav>
  </div>
</div>
    <div class="post-content">
      

<blockquote>
<p>增 删 改 查<br />
几乎所有的应用软件都需要数据库</p>
</blockquote>

<p><strong>数据库与数据结构的区别？</strong><br />
数据库是在应用软件级别研究数据的存储和操作    外存级别（硬盘）<br />
数据结构是在系统软件级别研究数据的存储和操作  内存级别<br />
<strong>什么是连接？</strong><br />
库本身和客户端sql server 是分开的需要连接服务<br />
sql结构化查询语句  是命令没有像编程语言的for循环之类  所以有些命令不能一起发送<br />
<strong>有了编程语言为什么还需要数据库？</strong><br />
对内存数据操作是编程语言的强项，但对硬盘数据的操作是数据库的强项。<br />
<em>数据库三方面</em><br />
<strong>一.数据库如何存储数据</strong><br />
字段 记录 表 约束（主键  外键  唯一键 非空 check  default 触发器）<br />
<strong>二.数据库如何操作数据</strong><br />
insert  update delete T-SQL  存储过程  函数 触发器<br />
<strong>三.数据库如何查询数据</strong><br />
select<br />
<em>mdf数据文件 LDF日志文件</em></p>

<h1 id="基础内容">基础内容</h1>

<p>1.表相关数据<br />
主键：唯一标识符  解决冗余数据问题
字段=列=属性<br />
记录=元祖<br />
表：记录的组合<br />
外键：一个表中若干字段来自另一个表若干字段的主键或唯一键 表事务与表事务之间的联系<br />
2.create table命令<br />
3.约束<br />
定义：对一个表中属性操作的限制<br />
分类：<br />
主键约束  不允许重复元素，避免了数据的冗余。<br />
外键约束  通过外键约束从语法上保证了本事务所关联的其他事物是存在的<br />
check约束  保证事物属性在一个规定值范围内<br />
default 保证事物属性一定会有一个值<br />
unique约束   保证事物属性不能重复 但与主键明显不同的是允许为空<br />
4.表和约束的异同<br />
5.什么是关系
分类：
一对一
一对多（在多的表中设置外键）<br />
多对多<br />
6.主键<br />
7.外键</p>

<h1 id="查询-顺序">查询 (顺序)</h1>

<h2 id="计算机列">计算机列</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></pre></td>
<td class="lntd">
<pre class="chroma">select * from emp;
	-- * 表示所有的
	-- from emp 表示从emp表查询

select empno, ename from emp;

select ename, sal from emp;

select ename, sal*12 as &#34;年薪&#34; from emp;
		--as 可以省略 记住: &#34;年薪&#34; 不要写成&#39;年薪&#39; 也不要写成 年薪

select ename, sal*12 as &#34;年薪&#34;, sal &#34;月薪&#34;, job from emp;

select 888 from emp;
	--ok
	--输出的行数是emp表的行数  每行只有一个字段，值是888

select 5;  --ok 
		   --不推荐	</pre></td></tr></table>
</div>
</div>
<h2 id="distinct-不允许重复的">distinct(不允许重复的)</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></pre></td>
<td class="lntd">
<pre class="chroma">select deptno from emp; --14行记录 不是3行记录

select distinct deptno from emp;  --distince deptno 会过滤掉重复的deptno
select distinct comm from emp;  --distinct也可以过滤掉重复的null  或者说如果有多个null 只输出一个
select distinct comm, deptno from emp;--把comm和deptno的组合进行过滤 
select deptno, distinct comm from emp;--error 逻辑上有冲突

select 10000 from emp; --14行记录</pre></td></tr></table>
</div>
</div>
<h2 id="between-在某个范围">between(在某个范围)</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></pre></td>
<td class="lntd">
<pre class="chroma">--查找工资在1500到3000之间(包括1500和3000)的所有的员工的信息
select * from emp 
	where sal&gt;=1500 and sal&lt;=3000
等价于
select * from emp 
	where sal between 1500 and 3000

--查找工资在小于1500或大于3000之间的所有的员工的信息
select * from emp 
	where sal&lt;1500 or sal&gt;3000
等价于
select * from emp 
	where sal not between 1500 and 3000
	</pre></td></tr></table>
</div>
</div>
<h2 id="in-属于若干个孤立的值">in(属于若干个孤立的值)</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></pre></td>
<td class="lntd">
<pre class="chroma">select * from emp where sal in (1500, 3000, 5000)
等价于
select * from emp 
	where sal=1500 or sal=3000 or sal=5000

select * from emp where sal not in (1500, 3000, 5000) --把sal既不是1500 也不是3000也不是5000的记录输出
等价于
select * from emp 
	where sal&lt;&gt;1500 and sal&lt;&gt;3000 and sal&lt;&gt;5000
		--数据库中不等于有两种表示：  !=    &lt;&gt;   推荐使用第二种
		--对或取反是并且  对并且取反是或</pre></td></tr></table>
</div>
</div>
<h2 id="top-最前面的若干个记录-专属sql-server的语法-不可移植到其他数据库">top(最前面的若干个记录 专属sql server的语法，不可移植到其他数据库)</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></pre></td>
<td class="lntd">
<pre class="chroma">select * from emp;

select top 5 * from emp;
select top 15 percent * from emp; --输出的是3个，不是2个

--把工资在1500到3000之间(包括1500和3000)的员工中工资最高的前4个人的信息输出
select top 4 * 
	from emp
	where sal between 1500 and 3000
	order by sal desc  --desc降序 不写则默认是升序
    执行顺序 过滤 排序 前四个</pre></td></tr></table>
</div>
</div>
<h2 id="null-没有值-空值">null（没有值，空值）</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></pre></td>
<td class="lntd">
<pre class="chroma">select * from emp;
--输出奖金非空的员工的信息
select * from emp where comm &lt;&gt; null; --输出为空 error
select * from emp where comm != null; --输出为空 error


select * from emp where comm = null;--输出为空 error
	--总结：null不能参与&lt;&gt;  !=  =运算

--null可以参与is  not is
select * from emp where comm is null; --输出奖金为空的员工的信息
select * from emp where comm is not null; --输出奖金不为空的员工的信息


--任何类型的数据都允许为null
create table t1 (name nvarchar(20), cnt int, riqi datetime);  
insert into t1 values (null, null, null)
select * from t1;


select * from emp;
--输出每个员工的姓名 年薪(包含了奖金)  comm假设是一年的奖金
select empno, ename, sal*12+comm &#34;年薪&#34; from emp;
	--本程序证明了：null不能参与任何数据运算 否则结果永远为空

	select ename, sal*12+isnull(comm, 0) &#34;年薪&#34; from emp;
	--isnull(comm, 0) 如果comm是null 就返回零 否则返回comm的值
 </pre></td></tr></table>
</div>
</div>
<h2 id="order-by-以某个字段排序">order by (以某个字段排序)</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></pre></td>
<td class="lntd">
<pre class="chroma">--asc是升序的意思 默认可以不写  desc是降序

select * from emp order by sal; --默认是按照升序排序
select * from emp order by deptno, sal; --先按照deptno升序排序，如果deptno相同，再按照sal升序排序

select * from emp order by deptno desc, sal;
	--先按deptno降序排序 如果deptno相同 再按照sal升序排序
	--记住sal是升序不是降序
	--order by a desc, b, c, d    desc只对a产生影响 不会对后面的b  c d 产生影响

select * from emp order by deptno, sal desc
	--问题：desc是否会对deptno产生影响?
	--答案：不会
	--先按deptno升序，如果deptno相同，再按sal降序
	</pre></td></tr></table>
</div>
</div>
<h2 id="模糊查询-搜索时经常用">模糊查询 (搜索时经常用)</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span></pre></td>
<td class="lntd">
<pre class="chroma">select * from emp 	where ename like &#39;%A%&#39;  --ename只要含有字母A就输出
select * from emp where ename like &#39;A%&#39;  --ename只要首字母是A的就输出
select * from emp where ename like &#39;%A&#39;  --ename只要尾字母是A的就输出


select * from emp where ename like &#39;_A%&#39; --ename只要第二个字母是A的就输出
 

select * from emp where ename like &#39;_[A-F]%&#39; --把ename中第二个字符是A或B或C或D或E或F的记录输出 


select * from emp where ename like &#39;_[^A-F]%&#39; --把ename中第二个字符不是A也不是B也不是C也不是D也不是E也不是F的记录输出 




select * from emp where ename like &#39;_[^A-F]%&#39; --把ename中第二个字符不是A也不是B也不是C也不是D也不是E也不是F的记录输出 



create table student
(
	name varchar(20) null
	,age int
);


insert into student values (&#39;张三&#39;, 88);
insert into student values (&#39;Tom&#39;, 66);
insert into student values (&#39;a_b&#39;, 22);
insert into student values (&#39;c%d&#39;, 44);
insert into student values (&#39;abc_fe&#39;, 56);
insert into student values (&#39;haobin&#39;, 25);
insert into student values (&#39;HaoBin&#39;, 88);
insert into student values (&#39;c%&#39;, 66)
insert into student values (&#39;long&#39;&#39;s&#39;, 100)
select * from student;

select * from student where name like &#39;%\%%&#39; escape &#39;\&#39;  --把name中包含有%的输出 
select * from student where name like &#39;%\_%&#39; escape &#39;\&#39; --把name中包含有_的输出</pre></td></tr></table>
</div>
</div>
<h2 id="聚合函数-多行记录返回一个值通常用于统计分组信息">聚合函数（多行记录返回一个值通常用于统计分组信息）</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></pre></td>
<td class="lntd">
<pre class="chroma">select lower(ename) from emp; -- 最终返回的是14行 lower()是单行函数
select max(sal) from emp; --返回1行 max()是多行函数

select * from emp;

select count(*) from emp;  --返回emp表所有记录的个数
select count(deptno) from emp;  --返回值是14 这说明deptno重复的记录也被当做有效的记录
select count(distinct deptno) from emp; --返回值是3  统计deptno不重复的记录的个数
select count(comm) from emp; --返回值是4 这说明comm为null的记录不会被当做有效的记录


select max(sal) &#34;最高工资&#34;, min(sal) &#34;最低工资&#34;, count(*) &#34;员工人数&#34; from emp; --ok 


select max(sal), lower(ename) from emp;</pre></td></tr></table>
</div>
</div>
<h2 id="group-by-分组-重点">group by (分组)【重点】</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span></pre></td>
<td class="lntd">
<pre class="chroma">use scott;
select * from emp;

--输出每个部门的编号 和 该部门的平均工资
select deptno, avg(sal) as &#34;部门平均工资&#34; 	
	from emp 
	group by deptno 

-- 判断下面语句是否正确
select deptno, avg(sal) as &#34;部门平均工资&#34;, ename
	from emp
	group by deptno 

-- 判断下面语句是否正确
select deptno, ename
	from emp
	group by deptno 


总结： 使用了group by 之后 select 中只能出现分组后的整体信息，不能出现组内的详细信息



group by a, b 的用法
--error
select deptno , job, sal
	from emp
	group by deptno, job

--error
select *
	from emp
	group by deptno, job

--ok
select deptno , job, avg(sal) &#34;平均工资&#34;
	from emp
	group by deptno, job
	order by deptno
--ok
select deptno , job, avg(sal) &#34;平均工资&#34;, count(*) &#34;部门人数&#34;, sum(sal) &#34;某部门某工作总工资&#34;, min(sal) &#34;某部门某工作最低工资&#34; 
	from emp
	group by deptno, job
	order by deptno
	

select comm, count(*) 
	from emp
	group by comm

select max(sal) from emp; --默认把所有的信息当做一组</pre></td></tr></table>
</div>
</div>
<h2 id="having-对分组之后的信息过滤-难点">having[对分组之后的信息过滤 难点]</h2>

<ol>
<li>having子句是用来对分组之后的数据进行过滤，因此使用having时通常都会先使用group by</li>

<li><p>如果没有使用group by 但使用了having 则意味着having 把所有的记录当做一组来进行过滤</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span></pre></td>
<td class="lntd">
<pre class="chroma">--输出部门平均工资大于2000的部门的部门编号 部门的平均工资
select deptno, avg(sal)
	from emp
	group by deptno
	having avg(sal) &gt; 2000


--判断下列sql语句是否正确
select deptno, avg(sal) as &#34;平均工资&#34;
	from emp
	group by deptno
	having avg(sal) &gt; 2000


--判断下列sql语句是否正确
select deptno, avg(sal) as &#34;平均工资&#34;
	from emp
	group by deptno
	having &#34;平均工资&#34; &gt; 2000

--判断下列sql语句是否正确
select deptno &#34;部门编号&#34;, avg(sal) as &#34;平均工资&#34;
	from emp
	group by deptno
	having deptno &gt; 10


--判断下列sql语句是否正确
select deptno &#34;部门编号&#34;, avg(sal) as &#34;平均工资&#34;
	from emp
	group by deptno
	having &#34;部门编号&#34; &gt; 1



--判断下列sql语句是否正确
select deptno, avg(sal) as &#34;平均工资&#34;
	from emp
	group by deptno
	having  deptno &gt; 10


--判断下列sql语句是否正确
select deptno, avg(sal) as &#34;平均工资&#34;
	from emp
	group by deptno
	having count(*) &gt;5 --统计部门个数大于5个的


--判断下列sql语句是否正确
select deptno, avg(sal) as &#34;平均工资&#34;
	from emp
	group by deptno
	having ename like &#39;%A%&#39;







--把姓名不包含A的所有的员工按部门编号分组，
--统计输出部门平均工资大于2000的部门的部门编号 部门的平均工资
select deptno, avg(sal) &#34;平均工资&#34;
	from emp
	where ename not like &#39;%A%&#39;
	group by deptno
	having avg(sal) &gt; 2000

--把工资大于2000，
--统计输出部门平均工资大于3000的部门的部门编号 部门的平均工资
select deptno, avg(sal) &#34;平均工资&#34;, count(*) &#34;部门人数&#34;, max(sal) &#34;部门的最高工资&#34;
	from emp
	where sal &gt; 2000  --where是对原始的记录过滤
	group by deptno
	having avg(sal) &gt; 3000  --对分组之后的记录过滤



--判断入选语句是否正确
select deptno, avg(sal) &#34;平均工资&#34;, count(*) &#34;部门人数&#34;, max(sal) &#34;部门的最高工资&#34;
	from emp	
	group by deptno
	having avg(sal) &gt; 3000  --对分组之后的记录过滤
	where sal &gt; 2000  --where是对原始的记录过滤

总计： 所有select的参数的顺序是不允许变化的，否则编译时出错 




select * from emp;



select count(*) 
	from emp 
	having avg(sal) &gt; 1000



select ename, sal &#34;工资&#34; 
	from emp
	where sal &gt; 2000

select ename, sal &#34;工资&#34; 
	from emp
	where &#34;工资&#34;  &gt; 2000



select deptno, avg(sal) &#34;平均工资&#34;, count(*) &#34;部门人数&#34;, max(sal) &#34;部门的最高工资&#34;
	into emp_2 //把查询结果放入一个新表
	from emp
	where sal &gt; 2000  --where是对原始的记录过滤
	group by deptno
	having avg(sal) &gt; 3000  --对分组之后的记录过滤

select * from emp_2</pre></td></tr></table>
</div>
</div></li>
</ol>

<h2 id="连接查询">连接查询</h2>

<h3 id="内连接">内连接</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span></pre></td>
<td class="lntd">
<pre class="chroma">select &#34;E&#34;.ename &#34;员工姓名&#34;, &#34;D&#34;.dname &#34;部门名称&#34;
	from emp &#34;E&#34;
	join dept &#34;D&#34;
	on &#34;E&#34;.deptno = &#34;D&#34;.deptno


1.
	select ... from A, B的用法
--emp是14行 8 列  dept是5行 3列
select * from emp, dept

2. 
	select ... from A, B where ... 的用法
--输出5行 11列
select * 
	from emp, dept 
	where empno = 7369

3. 
	select ... from A join B on ... 的用法
--输出11列 70行
select *
	from emp &#34;E&#34;
	join dept &#34;D&#34;  --join是连接
	on 1=1  --on连接条件

--输出2列 70行
select &#34;E&#34;.ename &#34;员工姓名&#34;, &#34;D&#34;.dname &#34;部门名称&#34;
	from emp &#34;E&#34;
	join dept &#34;D&#34;  --join是连接
	on 1=1  --on连接条件  on不能省 有join就必须有on

--判断下面语句是否正确
select deptno
	from emp &#34;E&#34;
	join dept &#34;D&#34;  --join是连接
	on 1=1 

--判断下面语句是否正确
select &#34;部门表&#34;.deptno &#34;部门编号&#34;
	from emp &#34;员工表&#34;
	join dept &#34;部门表&#34;  --join是连接
	on 1=1 


--考虑下面语句的输出结果是什么
--答案： 14行 11列
select *
	from emp &#34;E&#34;
	join dept &#34;D&#34;  --join是连接
	on &#34;E&#34;.deptno = &#34;D&#34;.deptno

--考虑下面语句的输出结果是什么
--答案：14行 2列
select &#34;E&#34;.ename &#34;员工姓名&#34;, &#34;D&#34;.dname &#34;部门名称&#34;
	from emp &#34;E&#34;
	join dept &#34;D&#34;  --join是连接
	on &#34;E&#34;.deptno = &#34;D&#34;.deptno








select * 
	from emp, dept
	where emp.deptno = dept.deptno

等价于
select * from emp
	join dept
	on emp.deptno = dept.deptno

--输出的行数肯定是dept表行数的倍数
select * from emp, dept 	
where emp.deptno =10 --5*3=15

--输出的行数肯定是emp表行数的倍数 
select * from emp, dept  
	where dept.deptno = 10   --14*1=14

	</pre></td></tr></table>
</div>
</div>
<h3 id="外连接">外连接</h3>

<h3 id="完全连接">完全连接</h3>

<h3 id="交叉连接">交叉连接</h3>

<h3 id="自连接">自连接</h3>

<h2 id="嵌套查询">嵌套查询</h2>

<h1 id="视图">视图</h1>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">文章作者</span>
    <span class="item-content">周军</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">上次更新</span>
    <span class="item-content">
        2019-09-10
        
    </span>
  </p>
  
  
</div>
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/sqlserver/">sqlserver</a>
          <a href="/tags/mysql/">mysql</a>
          <a href="/tags/db2/">db2</a>
          </div>
      <nav class="post-nav">
        
        <a class="next" href="/post/docker%E5%92%8Ck8s/">
            <span class="next-text nav-default">Docker和K8S</span>
            <span class="next-text nav-mobile">下一篇</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        
  
  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="email:1158290245@qq.com" class="iconfont icon-email" title="email"></a>
      <a href="https://github.com/junzhoublog" class="iconfont icon-github" title="github"></a>
      <a href="https://zhuanlan.zhihu.com/p/23014683" class="iconfont icon-zhihu" title="zhihu"></a>
      <a href="https://www.douban.com" class="iconfont icon-douban" title="douban"></a>
      <a href="https://www.bilibili.com" class="iconfont icon-bilibili" title="bilibili"></a>
  <a href="https://junzhoublog.github.io/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    由 <a class="hexo-link" href="https://gohugo.io">Hugo</a> 强力驱动
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    主题 - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2017 - 
    2019
    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">周军</span>
  </span>
</div>
    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>
<script type="text/javascript" src="/dist/even.26188efa.min.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]},
      TeX: {equationNumbers: {autoNumber: "AMS"}},
      showProcessingMessages: false,
      messageStyle: 'none'
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"  integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>








</body>
</html>
